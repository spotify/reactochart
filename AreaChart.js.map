{"version":3,"sources":["src/AreaChart.js"],"names":["AreaChart","React","Component","getDomain","props","data","x","y","yEnd","accessors","yDomain","shouldComponentUpdate","nextProps","nextState","shouldUpdate","render","xScale","yScale","isDifference","pathStyle","pathStylePositive","pathStyleNegative","shouldShowGaps","pathClassName","isDefined","curve","areaGenerator","defined","d","i","y0","y1","areaPathStr","height","clipBelowPathStr","clipAbovePathStr","chartId","_","uniqueId","clipAboveId","clipBelowId","pathStyleAbove","pathStyleBelow","PropTypes","array","isRequired","CustomPropTypes","valueOrAccessor","string","object","bool","func","xScaleType","yScaleType","isUndefined"],"mappings":"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","sourcesContent":["import { area } from \"d3\";\nimport _ from \"lodash\";\nimport PropTypes from \"prop-types\";\nimport React from \"react\";\nimport * as CustomPropTypes from \"./utils/CustomPropTypes\";\nimport { combineDomains, domainFromData, makeAccessor2 } from \"./utils/Data\";\nimport xyPropsEqual from \"./utils/xyPropsEqual\";\n\n/**\n * `AreaChart` represents a simple bivariate area chart,\n * a filled path drawn between two lines (datasets).\n */\n\n// todo horizontal prop, for filling area horizontally?\n// todo support ordinal (like days of the week) data?\n// todo build StackedAreaChart that composes multiple AreaCharts\n\nexport default class AreaChart extends React.Component {\n  static propTypes = {\n    /**\n     * the array of data objects\n     */\n    data: PropTypes.array.isRequired,\n    /**\n     * Accessor function for area X values, called once per datum,\n     * or a single Y value to be used for the entire line.\n     */\n    x: CustomPropTypes.valueOrAccessor,\n    /**\n     * Accessor function for area's starting (minimum) Y values, called once per datum,\n     * or a single Y value to be used for the entire line.\n     * Should return the minimum of the Y range spanned by the area at this point.\n     */\n    y: CustomPropTypes.valueOrAccessor,\n    /**\n     * Accessor function for area's ending (maximum) Y values, called once per datum,\n     * or a single Y value to be used for the entire line.\n     * Should return the maximum of the Y range spanned by the area at this point.\n     */\n    yEnd: CustomPropTypes.valueOrAccessor,\n    /**\n     * Class attribute to be applied to area path element.\n     */\n    pathClassName: PropTypes.string,\n    /**\n     * Inline style object to be applied to area path element.\n     */\n    pathStyle: PropTypes.object,\n    /**\n     * If isDifference is true, AreaChart generates a \"difference chart\" with two area paths instead of one:\n     * one path which shows when YEnd > Y, and one vice versa, allowing them to be styled differently (eg red/green).\n     */\n    isDifference: PropTypes.bool,\n    /**\n     * When isDifference is true, pathStylePositive and pathStyleNegative can be passed to give 2 different inline\n     * styles to the two different paths which are generated.\n     * Ignored if isDifference is false.\n     */\n    pathStylePositive: PropTypes.object,\n    pathStyleNegative: PropTypes.object,\n    /**\n     * If true, will show gaps in the shaded area for data where props.isDefined(datum) returns false.\n     */\n    shouldShowGaps: PropTypes.bool,\n    /**\n     * If shouldShowGaps is true, isDefined function describes when a datum should be considered \"defined\" vs. when to show gap\n     * by default, shows gap if either y or yEnd are undefined.\n     */\n    isDefined: PropTypes.func,\n    /**\n     * D3 scale for X axis - provided by XYPlot.\n     */\n    xScale: PropTypes.func,\n    /**\n     * D3 scale for Y axis - provided by XYPlot.\n     */\n    yScale: PropTypes.func,\n    /**\n     * Type of X scale - provided by XYPlot.\n     */\n    xScaleType: PropTypes.string,\n    /**\n     * Type of Y scale - provided by XYPlot.\n     */\n    yScaleType: PropTypes.string,\n    /**\n     * D3 curve for path generation\n     */\n    curve: PropTypes.func\n  };\n\n  static defaultProps = {\n    shouldShowGaps: true,\n    isDefined: (d, i, accessors) => {\n      return (\n        !_.isUndefined(accessors.y(d, i)) &&\n        !_.isUndefined(accessors.yEnd(d, i))\n      );\n    },\n    pathClassName: \"\"\n  };\n\n  static getDomain(props) {\n    // custom Y domain - the total (union) extent of getY and getYEnd combined\n    const { data, x, y, yEnd } = props;\n    const accessors = {\n      x: makeAccessor2(x),\n      y: makeAccessor2(y),\n      yEnd: makeAccessor2(yEnd)\n    };\n    return {\n      yDomain: combineDomains([\n        domainFromData(data, accessors.y),\n        domainFromData(data, accessors.yEnd)\n      ])\n    };\n  }\n\n  shouldComponentUpdate(nextProps, nextState) {\n    const shouldUpdate = !xyPropsEqual(this.props, nextProps, [\n      \"pathStyle\",\n      \"pathStylePositive\",\n      \"pathStyleNegative\"\n    ]);\n    return shouldUpdate;\n  }\n\n  render() {\n    const {\n      data,\n      x,\n      y,\n      yEnd,\n      xScale,\n      yScale,\n      isDifference,\n      pathStyle,\n      pathStylePositive,\n      pathStyleNegative,\n      shouldShowGaps,\n      pathClassName,\n      isDefined,\n      curve\n    } = this.props;\n    const accessors = {\n      x: makeAccessor2(x),\n      y: makeAccessor2(y),\n      yEnd: makeAccessor2(yEnd)\n    };\n\n    // create d3 area path generator\n    const areaGenerator = area();\n\n    // if gaps in data should be shown, use `props.isDefined` function as the `defined` param for d3's area generator;\n    // but wrap it & pass in accessors as well, so that the function can easily access the relevant data values\n    if (shouldShowGaps) {\n      areaGenerator.defined((d, i) => isDefined(d, i, accessors));\n    }\n\n    areaGenerator\n      .x((d, i) => xScale(accessors.x(d, i)))\n      .y0((d, i) => yScale(accessors.y(d, i)))\n      .y1((d, i) => yScale(accessors.yEnd(d, i)));\n\n    if (curve) {\n      areaGenerator.curve(curve);\n    }\n\n    const areaPathStr = areaGenerator(data);\n\n    if (isDifference) {\n      // difference chart - create 2 clip paths, one which clips to only show path where YEnd > Y, and other vice versa\n      areaGenerator.y0(this.props.height);\n      const clipBelowPathStr = areaGenerator(data);\n      areaGenerator.y0(0);\n      const clipAbovePathStr = areaGenerator(data);\n\n      // make sure we have a unique ID for this chart, so clip path IDs don't affect other charts\n      const chartId = _.uniqueId();\n      const clipAboveId = `clip-above-area-${chartId}`;\n      const clipBelowId = `clip-below-area-${chartId}`;\n      const pathStyleAbove = pathStylePositive || pathStyle || {};\n      const pathStyleBelow = pathStyleNegative || pathStyle || {};\n\n      return (\n        <g className=\"rct-area-chart--difference\">\n          <clipPath id={clipAboveId}>\n            <path className=\"rct-area-chart-path\" d={clipAbovePathStr} />\n          </clipPath>\n          <clipPath id={clipBelowId}>\n            <path className=\"rct-area-chart-path\" d={clipBelowPathStr} />\n          </clipPath>\n          <path\n            className={`rct-area-chart-path ${pathClassName}`}\n            d={areaPathStr}\n            clipPath={`url(#${clipAboveId})`}\n            style={pathStyleAbove}\n          />\n          <path\n            className={`rct-area-chart-path ${pathClassName}`}\n            d={areaPathStr}\n            clipPath={`url(#${clipBelowId})`}\n            style={pathStyleBelow}\n          />\n        </g>\n      );\n    } else {\n      return (\n        <g className=\"rct-area-chart\">\n          <path\n            className={`rct-area-chart-path ${pathClassName}`}\n            d={areaPathStr}\n            style={pathStyle || {}}\n          />\n        </g>\n      );\n    }\n  }\n}\n"],"file":"AreaChart.js"}